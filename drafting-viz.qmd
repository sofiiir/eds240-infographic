---
title: "drafting-viz"
format: html
author: Sofia Rodas
message: false
warning: false
---
# Global bat data exploration

This data was acquired from the open-source project intended to aggregate data for bats that live in karsts and caves. This data project is called [DarkCideS 1.0](https://darkcides.wordpress.com/). 

- What regions have the most bat studies? 

- What are bats feeding habits and ecosystem needs?

- What regions of the world have the greatest extinction risks for bats?

```{r}
#| message: false
#| warning: false

# load in necessary libraries
library(tidyverse)
library(camcorder) # to save an iteration of all of the visuals made in this qmd
library(png)
library(plotly)
```
I'm excited to see what camcorder creates from the visuals I make for this qmd. 
```{r}
gg_record(
  dir = file.path(here::here("data", "recording100")), # where to save the recording
  device = "png", # device to use to save images
  width = 4,      # width of saved image
  height = 6,     # height of saved image
  units = "in",   # units for width and height
  dpi = 300       # dpi to use when saving image
)
```


```{r}
#| message: false
#| warning: false

# read in data
bats <- read_csv(here::here("data", "figshare-bat-data", "Dataset_1.csv")) |> 
  janitor::clean_names()
```

### What are the different feeding groups in observed bats from caves and karsts?

Big bat broken up into feeding groups. 

### What ecosystems are bats that live in caves found in most often?
These values are held in columns that are dummy variables. They need to be cleaned for the graphing process. The end goal of the cleaning is a row for each combination of species and ecosystem type.

### Does feeding group influence which ecosystem cave bats frequent? 

I want to create a bar graph that shows how many bats were observed globally in each feeding group. 
```{r}
# calculate number of bats per feeding groups
bat_feeding_groups<- bats |> 
  group_by(feeding_groups) |> 
  summarise(value = n()) |> 
  arrange(value)

# create a bar plot displaying number of bat per feeding group
ggplot(bat_feeding_groups) +
  geom_col(aes(value, feeding_groups))+
  theme_minimal() +
  theme(axis.title = element_blank()) +
  labs(title = "Number of Bats per Feeding Group")
  
```
Define colors
```{r}
carnivore <- "#E6AA60"
sanguivore <- "#883955"
frugivore <- "#C4EBC8"
insectivore <- "#587792"
nectarivore <- "#D7A6B3"
omnivore <- "#07004D"
        
```

Make this info into one stacked barplot.
```{r}
ggplot(bat_feeding_groups, aes(fill= feeding_groups, y=value, x = "")) +
  geom_bar(position="fill", stat="identity") +
  scale_fill_manual(values = c(carnivore,
                               frugivore,
                               insectivore,
                               nectarivore,
                               omnivore,
                               sanguivore))+
  labs(y = "Percentage")+
  theme_minimal() + 
  theme(axis.title.x = element_blank()) 
```
Make a percentage column.
```{r}

```


```{r}
bat_img <- readPNG(here::here("data", "noun-bat-8134648.png"))
h <- dim(bat_img) [1]
w <- dim(bat_img) [2]
```

```{r}
# Find the rows where feet starts and head ends
pos1 <- which(apply(bat_img[,,1], 1, function(y) any(y==1)))
mn1 <- min(pos1)
mx1 <- max(pos1)
pospctM <- round((mx1-mn1)*pcts[2]/100+mn1)
pospctF <- round((mx1-mn1)*pcts[1]/100+mn1)
```


